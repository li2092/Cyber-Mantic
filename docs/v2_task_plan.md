# èµ›åšç„æ•° V2 ç‰ˆæœ¬ - ä»»åŠ¡è§„åˆ’ä¹¦

> æ›´æ–°æ—¶é—´ï¼š2026-01-08
> è´Ÿè´£äººï¼šClaude + å¤§é­”ç‹
> çŠ¶æ€ï¼šé˜¶æ®µäº”å®Œæˆ âœ…

---

## ä¸€ã€ç‰ˆæœ¬ç›®æ ‡

V2ç‰ˆæœ¬ä¸»è¦ç›®æ ‡ï¼š
1. **ç•Œé¢é‡æ„**ï¼šå·¦ä¾§å¯¼èˆªæ  + é—®é“å³ä¾§é¢æ¿ä¼˜åŒ–
2. **åŠŸèƒ½å¢å¼º**ï¼šMBTIé€‚é…ã€ä»²è£ç³»ç»Ÿã€åŠ¨æ€éªŒè¯ã€æ—¶è¾°æ™ºèƒ½å¤„ç†
3. **APIæ‹“å±•**ï¼šæ›´å¤šå‚å•†æ”¯æŒ + ç¯èŠ‚çº§è‡ªå®šä¹‰
4. **ä½“éªŒä¼˜åŒ–**ï¼šå¿«é€Ÿåˆ†ææ¸è¿›å±•ç¤º

---

## äºŒã€åŠŸèƒ½æ¨¡å—æ¸…å•

### 2.1 ç•Œé¢é‡æ„

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ | å¤æ‚åº¦ |
|------|------|--------|--------|
| å·¦ä¾§å¯¼èˆªæ  | æ›¿ä»£é¡¶éƒ¨æ ‡ç­¾é¡µï¼Œæ”¯æŒæ”¶èµ·/å±•å¼€ | P0 | é«˜ |
| LogoåŒºåŸŸ | å›¾æ ‡+ä¸­æ–‡å+è‹±æ–‡å | P0 | ä½ |
| å¯¼èˆªé¡¹å›¾æ ‡ | æ¯ä¸ªå¯¼èˆªé¡¹é…å›¾æ ‡ | P0 | ä½ |
| é—®é“å³ä¾§é¢æ¿ | è¿›åº¦â†’å¿«é€Ÿç»“è®ºâ†’åŸºæœ¬ä¿¡æ¯ | P0 | ä¸­ |
| å³ä¾§é¢æ¿æ‹–æ‹½ | å¯æ‹–æ‹½è°ƒæ•´å®½åº¦ | P1 | ä¸­ |
| è¾“å…¥æ¡†ç­‰å®½ | ä¸å¯¹è¯åŒºåŸŸç­‰å®½ | P0 | ä½ |

### 2.2 æ ¸å¿ƒåŠŸèƒ½å¢å¼º

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ | å¤æ‚åº¦ |
|------|------|--------|--------|
| MBTIé€‚é…çŸ©é˜µ | 16Ã—8å®Œæ•´é€‚é…åº¦è¡¨ | P1 | ä½ |
| ä»²è£ç³»ç»Ÿ | å†²çªæ—¶å¼•å…¥ç¬¬ä¸‰æ–¹ç†è®ºè£å†³ | P1 | ä¸­ |
| åŠ¨æ€å›æº¯éªŒè¯ | AIç”Ÿæˆ3ä¸ªé’ˆå¯¹æ€§éªŒè¯é—®é¢˜ | P1 | ä¸­ |
| å¿«é€Ÿåˆ†æåé¦ˆ | ç†è®ºå®Œæˆå³å±•ç¤ºï¼Œæ¸è¿›å¼ | P0 | ä¸­ |
| æ—¶è¾°æ™ºèƒ½å¤„ç† | ä¸‰æ–¹æ¡ˆæ··åˆï¼ˆä¸‰æŸ±/å¹¶è¡Œ/éªŒè¯ï¼‰ | P2 | é«˜ |
| çœŸå¤ªé˜³æ—¶æ ¡æ­£ | æ¨æ¼”æ¨¡å—ï¼Œæ ¹æ®ç»åº¦+åˆ†é’Ÿè®¡ç®— | P2 | ä¸­ |

### 2.3 APIæ‹“å±•

| åŠŸèƒ½ | æè¿° | ä¼˜å…ˆçº§ | å¤æ‚åº¦ |
|------|------|--------|--------|
| æ–°å¢å‚å•†æ”¯æŒ | é€šä¹‰åƒé—®ã€è±†åŒ…ã€ç™¾å·ã€æ™ºè°± | P1 | ä¸­ |
| ç¯èŠ‚çº§é…ç½® | æ¯ä¸ªAIè°ƒç”¨ç¯èŠ‚å¯å•ç‹¬é…ç½®API | P1 | é«˜ |
| é…ç½®æŒä¹…åŒ– | ç¯èŠ‚é…ç½®ä¿å­˜åˆ°è®¾ç½®æ–‡ä»¶ | P1 | ä½ |
| è®¾ç½®ç•Œé¢ | åˆ†ç¯èŠ‚è‡ªå®šä¹‰UI | P1 | ä¸­ |

---

## ä¸‰ã€æŠ€æœ¯è®¾è®¡è¦ç‚¹

### 3.1 å·¦ä¾§å¯¼èˆªæ 

```
ç»“æ„ï¼š
â”œâ”€â”€ SidebarWidget
â”‚   â”œâ”€â”€ LogoHeaderï¼ˆ80-100pxé«˜ï¼‰
â”‚   â”‚   â”œâ”€â”€ Logoå›¾æ ‡ï¼ˆå¯ç”¨ç°æœ‰app_icon.pngï¼‰
â”‚   â”‚   â”œâ”€â”€ ä¸­æ–‡åï¼šèµ›åšç„æ•°
â”‚   â”‚   â””â”€â”€ è‹±æ–‡åï¼šCyber Manticï¼ˆå°å­—ï¼‰
â”‚   â”œâ”€â”€ NavItemList
â”‚   â”‚   â”œâ”€â”€ NavItem: é—®é“ï¼ˆğŸ’¬ï¼‰
â”‚   â”‚   â”œâ”€â”€ NavItem: æ¨æ¼”ï¼ˆğŸ“Šï¼‰
â”‚   â”‚   â”œâ”€â”€ NavItem: å…¸ç±ï¼ˆğŸ“šï¼‰
â”‚   â”‚   â”œâ”€â”€ NavItem: æ´å¯Ÿï¼ˆğŸ‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ NavItem: å†å²ï¼ˆğŸ“œï¼‰
â”‚   â”‚   â””â”€â”€ NavItem: è®¾ç½®ï¼ˆâš™ï¸ï¼‰
â”‚   â”œâ”€â”€ Separator
â”‚   â””â”€â”€ NavItem: å…³äºï¼ˆâ„¹ï¸ï¼‰åº•éƒ¨å›ºå®š

æ”¶èµ·/å±•å¼€ï¼š
- å±•å¼€å®½åº¦ï¼š180px
- æ”¶èµ·å®½åº¦ï¼š60pxï¼ˆåªæ˜¾ç¤ºå›¾æ ‡ï¼‰
- åˆ‡æ¢æŒ‰é’®ï¼šåœ¨LogoåŒºåŸŸå³ä¸‹è§’
```

### 3.2 é—®é“å³ä¾§é¢æ¿

```
ç»“æ„ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰ï¼š
â”œâ”€â”€ ProgressSectionï¼ˆè¿›åº¦åŒºï¼‰
â”‚   â”œâ”€â”€ è¿›åº¦æ¡ï¼ˆProgressBarï¼‰
â”‚   â””â”€â”€ é˜¶æ®µæ–‡å­—ï¼ˆ"é˜¶æ®µ4: ç»“æœç¡®è®¤"ï¼‰
â”œâ”€â”€ QuickResultSectionï¼ˆå¿«é€Ÿç»“è®ºåŒºï¼‰
â”‚   â”œâ”€â”€ QuickResultCard: å°å…­å£¬
â”‚   â”œâ”€â”€ QuickResultCard: å…«å­—
â”‚   â”œâ”€â”€ QuickResultCard: å¥‡é—¨éç”²
â”‚   â””â”€â”€ ...
â””â”€â”€ InfoSectionï¼ˆåŸºæœ¬ä¿¡æ¯åŒºï¼‰
    â”œâ”€â”€ é—®é¢˜ä¿¡æ¯
    â”œâ”€â”€ æ—¶è¾°çŠ¶æ€
    â”œâ”€â”€ æ€§åˆ«
    â””â”€â”€ MBTI

å®½åº¦ï¼š200-300pxï¼Œå¯æ‹–æ‹½è°ƒæ•´
```

### 3.3 å¿«é€Ÿç»“è®ºå¡ç‰‡çŠ¶æ€

```
çŠ¶æ€æšä¸¾ï¼š
- WAITINGï¼ˆç­‰å¾…ä¸­ï¼‰ï¼šç°è‰²è¾¹æ¡†ï¼Œâ¬šå›¾æ ‡
- RUNNINGï¼ˆè¿›è¡Œä¸­ï¼‰ï¼šè“è‰²è¾¹æ¡†+åŠ¨ç”»ï¼Œâ³å›¾æ ‡
- COMPLETED_GOODï¼ˆå®Œæˆ-å‰ï¼‰ï¼šç»¿è‰²è¾¹æ¡†ï¼Œâœ…å›¾æ ‡
- COMPLETED_BADï¼ˆå®Œæˆ-å‡¶ï¼‰ï¼šçº¢è‰²è¾¹æ¡†ï¼Œâš ï¸å›¾æ ‡
- COMPLETED_NEUTRALï¼ˆå®Œæˆ-å¹³ï¼‰ï¼šæ©™è‰²è¾¹æ¡†ï¼Œâ–å›¾æ ‡
- ERRORï¼ˆå‡ºé”™ï¼‰ï¼šç°è‰²ï¼ŒâŒå›¾æ ‡

ä¿¡å·æœºåˆ¶ï¼š
- ConversationWorkeræ–°å¢ä¿¡å·ï¼š
  - theory_started(theory_name: str)
  - theory_completed(theory_name: str, result: dict)
  - quick_result(theory_name: str, summary: str, judgment: str)
```

### 3.4 MBTIé€‚é…çŸ©é˜µ

```python
# å®Œæ•´16Ã—8çŸ©é˜µ
MBTI_THEORY_MATRIX = {
    "INTJ": {"å…«å­—": 0.8, "å¥‡é—¨éç”²": 0.9, "æ¢…èŠ±æ˜“æ•°": 0.7, "å°å…­å£¬": 0.6, "æµ‹å­—æœ¯": 0.5, "å…­çˆ»": 0.7, "ç´«å¾®æ–—æ•°": 0.8, "å¤§å…­å£¬": 0.7},
    "INTP": {"å…«å­—": 0.9, "å¥‡é—¨éç”²": 0.7, "æ¢…èŠ±æ˜“æ•°": 0.8, "å°å…­å£¬": 0.5, "æµ‹å­—æœ¯": 0.6, "å…­çˆ»": 0.8, "ç´«å¾®æ–—æ•°": 0.9, "å¤§å…­å£¬": 0.6},
    # ... å…¶ä»–14ä¸ªç±»å‹
}

# åœ¨theory_selector.pyä¸­å®ç°æŸ¥è¡¨é€»è¾‘
def calculate_mbti_matching(mbti_type: str, theory: str) -> float:
    if mbti_type is None or mbti_type not in MBTI_THEORY_MATRIX:
        return 1.0  # æœªæä¾›MBTIä¸å½±å“é€‰æ‹©
    return MBTI_THEORY_MATRIX[mbti_type].get(theory, 0.7)
```

### 3.5 ä»²è£ç³»ç»Ÿ

```python
class ArbitrationSystem:
    """ä»²è£ç³»ç»Ÿï¼šå†²çªæ—¶å¼•å…¥ç¬¬ä¸‰æ–¹ç†è®ºè£å†³"""

    # ä»²è£ç†è®ºä¼˜å…ˆçº§ï¼ˆæŒ‰é—®é¢˜ç±»å‹ï¼‰
    ARBITRATION_PRIORITY = {
        "äº‹ä¸š": ["å…­çˆ»", "æ¢…èŠ±æ˜“æ•°", "å°å…­å£¬"],
        "æ„Ÿæƒ…": ["æµ‹å­—æœ¯", "æ¢…èŠ±æ˜“æ•°", "å…­çˆ»"],
        "è´¢è¿": ["å…­çˆ»", "å¥‡é—¨éç”²", "å°å…­å£¬"],
        "å¥åº·": ["å…­çˆ»", "å°å…­å£¬", "æ¢…èŠ±æ˜“æ•°"],
        "å†³ç­–": ["å¥‡é—¨éç”²", "å…­çˆ»", "å¤§å…­å£¬"],
    }

    def request_arbitration(self, conflict, question_type, used_theories) -> str:
        """è¯·æ±‚ä»²è£ç†è®º"""
        priority_list = self.ARBITRATION_PRIORITY.get(question_type, ["å…­çˆ»", "æ¢…èŠ±æ˜“æ•°"])
        for theory in priority_list:
            if theory not in used_theories:
                return theory
        return None

    def execute_arbitration(self, arbitration_theory, conflict_theories, user_input):
        """æ‰§è¡Œä»²è£åˆ†æ"""
        # 1. è®¡ç®—ä»²è£ç†è®º
        # 2. æ¯”è¾ƒä»²è£ç»“æœä¸å†²çªåŒæ–¹
        # 3. è¿”å›æœ€ç»ˆåˆ¤æ–­
        pass
```

### 3.6 åŠ¨æ€å›æº¯éªŒè¯

```python
class DynamicVerificationGenerator:
    """åŠ¨æ€ç”ŸæˆéªŒè¯é—®é¢˜"""

    async def generate_questions(self, user_info: dict, analysis_results: dict) -> List[dict]:
        """
        æ ¹æ®ç”¨æˆ·ä¿¡æ¯å’Œåˆ†æç»“æœç”Ÿæˆ3ä¸ªé’ˆå¯¹æ€§éªŒè¯é—®é¢˜

        ç­–ç•¥ï¼š
        1. åŸºäºç”¨æˆ·å¹´é¾„è®¡ç®—å…³é”®å¹´ä»½ï¼ˆå©šå§»ã€äº‹ä¸šè½¬æŠ˜ç­‰ï¼‰
        2. åŸºäºé—®é¢˜ç±»åˆ«é€‰æ‹©ç›¸å…³é¢†åŸŸ
        3. åŸºäºç†è®ºé¢„æµ‹çš„"åº”éªŒå¹´"ç”ŸæˆéªŒè¯
        """
        prompt = f"""
        ç”¨æˆ·ä¿¡æ¯ï¼š{json.dumps(user_info, ensure_ascii=False)}
        åˆ†æç»“æœï¼š{json.dumps(analysis_results, ensure_ascii=False)}

        è¯·ç”Ÿæˆ3ä¸ªå›æº¯éªŒè¯é—®é¢˜ï¼Œè¦æ±‚ï¼š
        1. é—®é¢˜æ¶‰åŠè¿‡å»3-5å¹´å†…çš„å…·ä½“äº‹ä»¶
        2. ä¸ç”¨æˆ·å’¨è¯¢çš„é—®é¢˜ç±»åˆ«ç›¸å…³
        3. ç­”æ¡ˆæ˜ç¡®ï¼ˆæ˜¯/å¦/å¤§è‡´æ—¶é—´ï¼‰
        4. ç”¨äºéªŒè¯åˆ†æå‡†ç¡®æ€§

        è¿”å›JSONæ ¼å¼ï¼š
        [
            {"question": "...", "type": "yes_no|year|event", "purpose": "..."},
            ...
        ]
        """
        # è°ƒç”¨AIç”Ÿæˆ
        response = await self.api_manager.call_api(prompt=prompt, task_type="å›æº¯éªŒè¯ç”Ÿæˆ")
        return json.loads(response)
```

### 3.7 æ—¶è¾°æ™ºèƒ½å¤„ç†ï¼ˆæ··åˆæ–¹æ¡ˆï¼‰

```python
class ShichenHandler:
    """æ—¶è¾°çŠ¶æ€ç»Ÿä¸€å¤„ç†å™¨"""

    class Status(Enum):
        KNOWN_EXACT = "known_exact"      # ç¡®åˆ‡çŸ¥é“
        KNOWN_RANGE = "known_range"      # çŸ¥é“èŒƒå›´ï¼ˆé—®é“ä¸“ç”¨ï¼‰
        UNCERTAIN = "uncertain"          # ä¸ç¡®å®šæ˜¯å¦å‡†ç¡®
        UNKNOWN = "unknown"              # å®Œå…¨ä¸çŸ¥é“

    def process(self, user_input, life_events=None):
        """å¤„ç†æ—¶è¾°å¹¶è¿”å›åˆ†æç­–ç•¥"""

        if self.status == self.Status.KNOWN_EXACT:
            return {"strategy": "full_analysis", "confidence": 0.95}

        elif self.status == self.Status.KNOWN_RANGE:
            # æ–¹æ¡ˆäºŒï¼šèŒƒå›´å†…å¹¶è¡Œè®¡ç®—
            candidates = self._get_range_candidates()
            return {"strategy": "parallel", "candidates": candidates, "confidence": 0.7}

        elif self.status == self.Status.UNCERTAIN:
            # æ–¹æ¡ˆä¸‰ï¼šäº‹ä»¶éªŒè¯
            if life_events:
                validation = self._validate_with_events(life_events)
                return {"strategy": "validated", "confidence": validation["confidence"]}
            return {"strategy": "degraded", "confidence": 0.6}

        else:  # UNKNOWN
            # æ–¹æ¡ˆä¸€ï¼šä¸‰æŸ±é™çº§ + ä¸ä¾èµ–æ—¶è¾°çš„ç†è®ºä¼˜å…ˆ
            return {
                "strategy": "degraded",
                "bazi_mode": "three_pillars",
                "ziwei_mode": "disabled",
                "enabled_theories": ["å…­çˆ»", "æ¢…èŠ±æ˜“æ•°", "å°å…­å£¬", "æµ‹å­—æœ¯", "å¥‡é—¨éç”²", "å¤§å…­å£¬"],
                "confidence": 0.5
            }
```

### 3.8 APIç¯èŠ‚çº§é…ç½®

```python
# é…ç½®ç»“æ„
API_TASK_CONFIG = {
    "global": {
        "primary": "claude",
        "fallback_order": ["deepseek", "kimi", "gemini"],
    },
    "task_overrides": {
        "ç»¼åˆæŠ¥å‘Šè§£è¯»": {"api": "claude", "model": "claude-3-opus"},
        "å¿«é€Ÿäº¤äº’é—®ç­”": {"api": "kimi", "model": "kimi-k2-turbo"},
        "å†²çªè§£å†³åˆ†æ": {"api": "deepseek", "model": "deepseek-reasoner"},
        "å›æº¯éªŒè¯ç”Ÿæˆ": {"api": "gemini", "model": "gemini-pro"},
        "ç†è®ºè§£è¯»": None,  # Noneè¡¨ç¤ºä½¿ç”¨å…¨å±€é…ç½®
    }
}

# æ”¯æŒçš„APIå‚å•†
SUPPORTED_APIS = {
    "claude": {"vendor": "Anthropic", "models": ["claude-3-opus", "claude-3-sonnet", "claude-3-haiku"]},
    "deepseek": {"vendor": "DeepSeek", "models": ["deepseek-chat", "deepseek-reasoner"]},
    "kimi": {"vendor": "Moonshot", "models": ["kimi-k2", "kimi-k2-turbo"]},
    "gemini": {"vendor": "Google", "models": ["gemini-pro", "gemini-ultra"]},
    "qwen": {"vendor": "é˜¿é‡Œé€šä¹‰", "models": ["qwen-max", "qwen-plus", "qwen-turbo"]},
    "doubao": {"vendor": "å­—èŠ‚è±†åŒ…", "models": ["doubao-pro", "doubao-lite"]},
    "baichuan": {"vendor": "ç™¾å·", "models": ["baichuan-4", "baichuan-3-turbo"]},
    "glm": {"vendor": "æ™ºè°±æ¸…è¨€", "models": ["glm-4", "glm-4-flash", "glm-3-turbo"]},
}
```

---

## å››ã€å¼€å‘è®¡åˆ’

### é˜¶æ®µä¸€ï¼šç•Œé¢é‡æ„ï¼ˆ2å‘¨ï¼‰âœ… å·²å®Œæˆ

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– | çŠ¶æ€ |
|------|------|------|------|------|
| 1.1 å·¦ä¾§å¯¼èˆªæ ç»„ä»¶ | SidebarWidget + NavItem | 2å¤© | æ—  | âœ… |
| 1.2 LogoåŒºåŸŸ | LogoHeaderç»„ä»¶ | 0.5å¤© | æ—  | âœ… |
| 1.3 MainWindowé‡æ„ | æ›¿æ¢TabWidgetä¸ºå·¦ä¾§å¯¼èˆª | 1.5å¤© | 1.1 | âœ… |
| 1.4 æ”¶èµ·/å±•å¼€åŠŸèƒ½ | æ±‰å ¡èœå•æŒ‰é’®+çŠ¶æ€åˆ‡æ¢ | 1å¤© | 1.3 | âœ… |
| 1.5 é—®é“å³ä¾§é¢æ¿ | ProgressPanel + QuickResultCard + InfoPanel | 2å¤© | 1.3 | âœ… |
| 1.6 æ‹–æ‹½è°ƒæ•´å®½åº¦ | QSplitterä¼˜åŒ– | 0.5å¤© | 1.5 | âœ… |
| 1.7 è¾“å…¥æ¡†ç­‰å®½ | å¸ƒå±€è°ƒæ•´ | 0.5å¤© | 1.5 | âœ… |
| 1.8 ä¸»é¢˜é€‚é… | æ·±è‰²ä¸»é¢˜æ ·å¼ | 1å¤© | 1.1-1.7 | âœ… |
| 1.9 èŠå¤©æ°”æ³¡ä¼˜åŒ– | AIå¤´åƒä¸Šæ–¹+ç”¨æˆ·ç´«è‰²æ°”æ³¡+æ‰“å­—åŠ¨ç”» | 0.5å¤© | 1.5 | âœ… |
| 1.10 è¾“å…¥æ¡†é…è‰² | æ·±è‰²ä¸»é¢˜å‹å¥½é…è‰² | 0.5å¤© | 1.8 | âœ… |

### é˜¶æ®µäºŒï¼šå¿«é€Ÿåˆ†æåé¦ˆ + MBTIï¼ˆ2å‘¨ï¼‰âœ… å·²å®Œæˆ

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– | çŠ¶æ€ |
|------|------|------|------|------|
| 2.1 Workerä¿¡å·æœºåˆ¶ | æ–°å¢theory_started/completedä¿¡å· | 1å¤© | é˜¶æ®µä¸€ | âœ… |
| 2.2 å¿«é€Ÿç»“è®ºå¡ç‰‡äº¤äº’ | çŠ¶æ€åˆ‡æ¢ã€åŠ¨ç”»æ•ˆæœ | 1å¤© | 1.5 | âœ… |
| 2.3 æ¸è¿›å±•ç¤ºé€»è¾‘ | ç†è®ºå®Œæˆå³æ›´æ–°UI | 1.5å¤© | 2.1, 2.2 | âœ… |
| 2.4 MBTIçŸ©é˜µæ•°æ® | è¡¥å……å®Œæ•´16Ã—8çŸ©é˜µ | 0.5å¤© | æ—  | âœ… |
| 2.5 MBTIåŒ¹é…ç®—æ³• | theory_selector.pyå®ç° | 0.5å¤© | 2.4 | âœ… |
| 2.6 MBTIå¯¹æŠ¥å‘Šå½±å“ | ä¸ªæ€§åŒ–è¡¨è¾¾è°ƒæ•´ | 1å¤© | 2.5 | âœ… |

### é˜¶æ®µä¸‰ï¼šåŠ¨æ€éªŒè¯ + APIæ‹“å±•ï¼ˆ2å‘¨ï¼‰âœ… å·²å®Œæˆ

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– | çŠ¶æ€ |
|------|------|------|------|------|
| 3.1 åŠ¨æ€é—®é¢˜ç”Ÿæˆ | DynamicVerificationGenerator | 1.5å¤© | æ—  | âœ… |
| 3.2 éªŒè¯é—®é¢˜UI | å¯¹è¯ä¸­å±•ç¤ºéªŒè¯é—®é¢˜ | 1å¤© | 3.1 | âœ… |
| 3.3 éªŒè¯ç»“æœå¤„ç† | æ›´æ–°ç½®ä¿¡åº¦é€»è¾‘ | 1å¤© | 3.2 | âœ… |
| 3.4 æ–°å¢APIå®¢æˆ·ç«¯ | qwen/doubao/baichuan/glm + OpenRouter | 2å¤© | æ—  | âœ… |
| 3.5 ç¯èŠ‚é…ç½®æ•°æ®ç»“æ„ | TaskRouter + TaskConfig | 0.5å¤© | 3.4 | âœ… |
| 3.6 é…ç½®æŒä¹…åŒ– | ä¿å­˜åˆ°api_task_config.json | 0.5å¤© | 3.5 | âœ… |

### é˜¶æ®µå››ï¼šä»²è£ç³»ç»Ÿ + APIé…ç½®UIï¼ˆ2å‘¨ï¼‰âœ… å·²å®Œæˆ

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– | çŠ¶æ€ |
|------|------|------|------|------|
| 4.1 ArbitrationSystem | ä»²è£ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘ | 1.5å¤© | æ—  | âœ… |
| 4.2 ä»²è£è§¦å‘é€»è¾‘ | å†²çªè§£å†³å™¨é›†æˆ | 1å¤© | 4.1 | âœ… |
| 4.3 ä»²è£ç»“æœå±•ç¤º | UIå±•ç¤ºä»²è£è¿‡ç¨‹ | 1å¤© | 4.2 | â³ å¾…å®Œå–„ |
| 4.4 APIè®¾ç½®ç•Œé¢ | å…¨å±€+åˆ†ç¯èŠ‚é…ç½®UI | 2å¤© | 3.5 | âœ… |
| 4.5 è¿æ¥æµ‹è¯•åŠŸèƒ½ | æµ‹è¯•å„APIè¿é€šæ€§ | 0.5å¤© | 4.4 | âœ… |

### é˜¶æ®µäº”ï¼šæ—¶è¾°æ™ºèƒ½å¤„ç† + çœŸå¤ªé˜³æ—¶ï¼ˆ3å‘¨ï¼‰âœ… å·²å®Œæˆ

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– | çŠ¶æ€ |
|------|------|------|------|------|
| 5.1 ShichenHandler | æ—¶è¾°çŠ¶æ€å¤„ç†å™¨ | 1.5å¤© | æ—  | âœ… |
| 5.2 ä¸‰æŸ±åˆ†ææ¨¡å¼ | å…«å­—é™çº§è®¡ç®— | 1.5å¤© | 5.1 | âœ… |
| 5.3 å¹¶è¡Œè®¡ç®—æ¨¡å¼ | å¤šæ—¶è¾°å€™é€‰åˆ†æ | 2å¤© | 5.1 | âœ… |
| 5.4 äº‹ä»¶éªŒè¯æ¨æ–­ | åŸºäºå†å²äº‹ä»¶ç¼©å°èŒƒå›´ | 2å¤© | 5.1 | â³ TODO stub |
| 5.5 NLPè§£ææ‰©å±• | è¯†åˆ«known_rangeçŠ¶æ€ | 1å¤© | 5.1 | âœ… |
| 5.6 çœŸå¤ªé˜³æ—¶æ ¡æ­£ | æ¨æ¼”æ¨¡å—è®¡ç®—é€»è¾‘ | 1.5å¤© | æ—  | âœ… |
| 5.7 æ¨æ¼”UIè°ƒæ•´ | ç»åº¦è¾“å…¥+æç¤º | 0.5å¤© | 5.6 | â³ å¾…å®ç° |
| 5.8 FlowGuardæ ¸å¿ƒ | æµç¨‹ç›‘ç®¡æ¨¡å—è®¾è®¡ | 1å¤© | æ—  | âœ… |
| 5.9 éªŒè¯å™¨å®ç° | å„é˜¶æ®µè¾“å…¥éªŒè¯å™¨ | 0.5å¤© | 5.8 | âœ… |
| 5.10 è¿›åº¦å±•ç¤º | ç±»todoè¿›åº¦UI | 0.5å¤© | 5.8 | âœ… |
| 5.11 é›†æˆåˆ°é—®é“ | ConversationServiceé›†æˆ | 1å¤© | 5.8 | âœ… |
| 5.12 åˆ¤æ–­èŠ‚ç‚¹æ¢³ç† | 18ä¸ªèŠ‚ç‚¹AI+ä»£ç æœºåˆ¶åˆ†æ | 0.5å¤© | 5.11 | âœ… |

### é˜¶æ®µå…­ï¼šæµ‹è¯•ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

| ä»»åŠ¡ | æè¿° | å·¥æ—¶ | ä¾èµ– |
|------|------|------|------|
| 6.1 ç•Œé¢æµ‹è¯• | å„æ¨¡å—UIæµ‹è¯• | 1å¤© | é˜¶æ®µä¸€ |
| 6.2 åŠŸèƒ½æµ‹è¯• | å®Œæ•´æµç¨‹æµ‹è¯• | 2å¤© | é˜¶æ®µäºŒ-äº” |
| 6.3 APIæµ‹è¯• | å¤šå‚å•†åˆ‡æ¢æµ‹è¯• | 1å¤© | é˜¶æ®µä¸‰-å›› |
| 6.4 æ€§èƒ½ä¼˜åŒ– | åŠ è½½é€Ÿåº¦ã€å“åº”æ—¶é—´ | 1å¤© | å…¨éƒ¨ |

---

## äº”ã€å¼€å‘é¡ºåºæ€»è§ˆ

```
ç¬¬1-2å‘¨ï¼šé˜¶æ®µä¸€ï¼ˆç•Œé¢é‡æ„ï¼‰
    â†“
ç¬¬3-4å‘¨ï¼šé˜¶æ®µäºŒï¼ˆå¿«é€Ÿåˆ†æåé¦ˆ + MBTIï¼‰
    â†“
ç¬¬5-6å‘¨ï¼šé˜¶æ®µä¸‰ï¼ˆåŠ¨æ€éªŒè¯ + APIæ‹“å±•ï¼‰
    â†“
ç¬¬7-8å‘¨ï¼šé˜¶æ®µå››ï¼ˆä»²è£ç³»ç»Ÿ + APIé…ç½®UIï¼‰
    â†“
ç¬¬9-11å‘¨ï¼šé˜¶æ®µäº”ï¼ˆæ—¶è¾°æ™ºèƒ½å¤„ç† + çœŸå¤ªé˜³æ—¶ï¼‰
    â†“
ç¬¬12å‘¨ï¼šé˜¶æ®µå…­ï¼ˆæµ‹è¯•ä¼˜åŒ–ï¼‰
```

**æ€»è®¡ï¼šçº¦12å‘¨ï¼ˆ3ä¸ªæœˆï¼‰**

---

## å…­ã€å…³é”®æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆV2å·²å®Œæˆï¼‰

```
cyber_mantic/ui/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ sidebar.py              # å·¦ä¾§å¯¼èˆªæ  âœ…
â”‚   â”œâ”€â”€ nav_item.py             # å¯¼èˆªé¡¹ âœ…
â”‚   â””â”€â”€ __init__.py             # ç»„ä»¶æ¨¡å— âœ…
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ quick_result_card.py    # å¿«é€Ÿç»“è®ºå¡ç‰‡ âœ…
â”‚   â”œâ”€â”€ chat_widget.py          # èŠå¤©ç»„ä»¶ï¼ˆé‡æ„ï¼‰âœ…
â”‚   â”œâ”€â”€ markdown_webview.py     # Markdownæ¸²æŸ“ âœ…
â”‚   â”œâ”€â”€ verification_widget.py  # éªŒè¯é—®é¢˜ç»„ä»¶ âœ…
â”‚   â””â”€â”€ api_settings_widget.py  # APIè®¾ç½®ç»„ä»¶ âœ…

cyber_mantic/core/
â”œâ”€â”€ arbitration_system.py       # ä»²è£ç³»ç»Ÿ âœ…
â”œâ”€â”€ shichen_handler.py          # æ—¶è¾°å¤„ç†å™¨ âœ…
â”œâ”€â”€ dynamic_verification.py     # åŠ¨æ€éªŒè¯ç”Ÿæˆ âœ…
â”œâ”€â”€ theory_selector.py          # ç†è®ºé€‰æ‹©å™¨ï¼ˆå«MBTIçŸ©é˜µï¼‰âœ…
â”œâ”€â”€ flow_guard.py               # æµç¨‹ç›‘ç®¡æ¨¡å— âœ… [æ–°å¢]
â””â”€â”€ __init__.py                 # æ ¸å¿ƒæ¨¡å—å¯¼å‡º âœ…

cyber_mantic/api/
â”œâ”€â”€ clients/
â”‚   â”œâ”€â”€ qwen_client.py          # é€šä¹‰åƒé—® âœ…
â”‚   â”œâ”€â”€ doubao_client.py        # å­—èŠ‚è±†åŒ… âœ…
â”‚   â”œâ”€â”€ baichuan_client.py      # ç™¾å· âœ…
â”‚   â”œâ”€â”€ glm_client.py           # æ™ºè°±æ¸…è¨€ âœ…
â”‚   â””â”€â”€ openrouter_client.py    # OpenRouterèšåˆ âœ…
â”œâ”€â”€ task_router.py              # ç¯èŠ‚çº§è·¯ç”± âœ…
â””â”€â”€ unified_client.py           # ç»Ÿä¸€å®¢æˆ·ç«¯ âœ…

cyber_mantic/utils/
â””â”€â”€ time_utils.py               # æ—¶é—´å·¥å…·ï¼ˆå«çœŸå¤ªé˜³æ—¶ï¼‰âœ…

cyber_mantic/services/conversation/
â””â”€â”€ nlp_parser.py               # NLPè§£æå™¨ï¼ˆV2å¢å¼ºï¼‰âœ…

cyber_mantic/theories/bazi/
â””â”€â”€ calculator.py               # å…«å­—è®¡ç®—å™¨ï¼ˆå«ä¸‰æŸ±/å¹¶è¡Œï¼‰âœ…
```

### ä¿®æ”¹æ–‡ä»¶

```
cyber_mantic/ui/
â”œâ”€â”€ main_window.py              # é‡æ„ä¸ºå·¦ä¾§å¯¼èˆªå¸ƒå±€
â””â”€â”€ tabs/
    â””â”€â”€ ai_conversation_tab.py  # é€‚é…æ–°å¸ƒå±€

cyber_mantic/core/
â”œâ”€â”€ theory_selector.py          # æ·»åŠ MBTIçŸ©é˜µ
â””â”€â”€ conflict_resolver.py        # é›†æˆä»²è£ç³»ç»Ÿ

cyber_mantic/services/
â””â”€â”€ conversation_service.py     # é›†æˆåŠ¨æ€éªŒè¯

cyber_mantic/api/
â””â”€â”€ manager.py                  # æ”¯æŒç¯èŠ‚çº§é…ç½®

cyber_mantic/theories/bazi/
â””â”€â”€ calculator.py               # ä¸‰æŸ±åˆ†ææ¨¡å¼
```

---

## ä¸ƒã€é£é™©ä¸æ³¨æ„äº‹é¡¹

1. **ç•Œé¢é‡æ„é£é™©**ï¼šæ”¹åŠ¨è¾ƒå¤§ï¼Œéœ€è¦å……åˆ†æµ‹è¯•
2. **APIå…¼å®¹æ€§**ï¼šæ–°å¢å‚å•†éœ€è¦å¤„ç†ä¸åŒçš„é”™è¯¯ç å’Œé™æµç­–ç•¥
3. **æ—¶è¾°å¤„ç†å¤æ‚åº¦**ï¼šå¹¶è¡Œè®¡ç®—æ¨¡å¼å¯èƒ½å¢åŠ APIè°ƒç”¨æˆæœ¬
4. **å‘åå…¼å®¹**ï¼šç¡®ä¿è€ç”¨æˆ·æ•°æ®ä¸ä¸¢å¤±

---

## å…«ã€å¾…ç¡®è®¤äº‹é¡¹

- [x] å·¦ä¾§å¯¼èˆªæ æ”¶èµ·/å±•å¼€ï¼šè¦
- [x] LogoåŒºåŸŸé«˜åº¦ï¼šç¾è§‚ä¸ºå‡†ï¼ˆ80-100pxï¼‰
- [x] å¯¼èˆªé¡¹å›¾æ ‡ï¼šè¦
- [x] å³ä¾§é¢æ¿æ‹–æ‹½ï¼šå¯ä»¥
- [x] æ¨æ¼”æ¨¡å—æ—¶è¾°é€‰é¡¹ï¼šä¿æŒ3ä¸ªï¼Œä¸æ”¹4ä¸ª
- [x] çœŸå¤ªé˜³æ—¶æ ¡æ­£ï¼šåªåœ¨æ¨æ¼”æ¨¡å—
- [ ] Logoå›¾æ ‡ä½¿ç”¨ç°æœ‰è¿˜æ˜¯æ–°è®¾è®¡ï¼Ÿ
- [ ] æ·±è‰²ä¸»é¢˜æ˜¯å¦åŒæ­¥å¼€å‘ï¼Ÿ

---

*æ­¤æ–‡æ¡£å°†éšå¼€å‘è¿›åº¦æŒç»­æ›´æ–°*
